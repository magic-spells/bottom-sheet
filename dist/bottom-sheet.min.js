!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).BottomSheet={})}(this,function(e){"use strict";const t=(e,t)=>{let n;return function(...o){n||(e.apply(this,o),n=!0,setTimeout(()=>n=!1,t))}};class BottomSheet extends HTMLElement{#e={};#t=.1;#n=100;#o=1/0;#r=0;static get observedAttributes(){return["max-display-width"]}attributeChangedCallback(e,t,n){const o=this;if(t!==n&&"max-display-width"===e)if(null===n||"none"===n)o.maxDisplayWidth=1/0;else{const e=parseInt(n);o.maxDisplayWidth=isNaN(e)?1/0:e}}get maxDisplayWidth(){return this.#o}set maxDisplayWidth(e){const t=this;t.#o=e,e===1/0?t.removeAttribute("max-display-width"):t.setAttribute("max-display-width",e)}constructor(){super();const e=this;e.setAttribute("aria-hidden",!0);const n=e.getAttribute("max-display-width");if(null!==n&&"none"!==n){const t=parseInt(n);e.maxDisplayWidth=isNaN(t)?1/0:t}else e.maxDisplayWidth=1/0;e.drag={isDragging:!1,startY:0,currentY:0,endY:0,delta:0,direction:null,isHeader:!1,isOverlay:!1,isAtTop:!1},e.panel=e.querySelector(":scope > bottom-sheet-panel"),e.panelContent=e.panel?.querySelector(":scope > bottom-sheet-content"),e.overlay=e.querySelector("bottom-sheet-overlay"),e.header=e.querySelector("bottom-sheet-header"),e.#e={touchStart:e.panelDragStart.bind(e),touchMove:e.panelDragMove.bind(e),touchEnd:e.panelDragEnd.bind(e),transitionEnd:e.handleTransitionEnd.bind(e),overlayClick:e.hide.bind(e),windowResize:t(()=>{window.innerWidth>e.maxDisplayWidth&&e.hide()},100),actionClick:t=>{t.target.closest("[data-action-hide-bottom-sheet]")&&(t.preventDefault(),e.hide())}},e.setupAriaAttributes()}setupAriaAttributes(){const e=this;e.setAttribute("role","dialog"),e.setAttribute("aria-hidden","true"),e.setAttribute("aria-modal","true"),e.setAttribute("inert",""),e.hasAttribute("aria-label")||e.setAttribute("aria-label","Bottom sheet content")}#a=e=>{const t=this;"Escape"===e.key&&"false"===t.getAttribute("aria-hidden")&&(e.preventDefault(),t.hide())};bindUI(){const e=this;window.addEventListener("resize",e.#e.windowResize),e.header&&(e.header.addEventListener("touchstart",e.#e.touchStart,!0),e.header.addEventListener("touchmove",e.#e.touchMove,!1),e.header.addEventListener("touchend",e.#e.touchEnd),e.header.addEventListener("touchcancel",e.#e.touchEnd)),e.panelContent&&(e.panelContent.addEventListener("touchstart",e.#e.touchStart,!0),e.panelContent.addEventListener("touchmove",e.#e.touchMove,!1),e.panelContent.addEventListener("touchend",e.#e.touchEnd),e.panelContent.addEventListener("touchcancel",e.#e.touchEnd)),e.overlay&&(e.overlay.addEventListener("touchstart",e.#e.touchStart,!0),e.overlay.addEventListener("touchmove",e.#e.touchMove,!1),e.overlay.addEventListener("touchend",e.#e.touchEnd),e.overlay.addEventListener("touchcancel",e.#e.touchEnd),e.overlay.addEventListener("click",e.#e.overlayClick)),e.panel&&(e.panel.addEventListener("transitionend",e.#e.transitionEnd),e.panel.addEventListener("click",e.#e.actionClick)),document.addEventListener("keydown",e.#a)}connectedCallback(){const e=this;e.bindUI(),window.innerWidth>e.maxDisplayWidth&&e.hide()}disconnectedCallback(){const e=this;window.removeEventListener("resize",e.#e.windowResize),e.header&&(e.header.removeEventListener("touchstart",e.#e.touchStart,!0),e.header.removeEventListener("touchmove",e.#e.touchMove,!1),e.header.removeEventListener("touchend",e.#e.touchEnd),e.header.removeEventListener("touchcancel",e.#e.touchEnd)),e.panelContent&&(e.panelContent.removeEventListener("touchstart",e.#e.touchStart,!0),e.panelContent.removeEventListener("touchmove",e.#e.touchMove,!1),e.panelContent.removeEventListener("touchend",e.#e.touchEnd),e.panelContent.removeEventListener("touchcancel",e.#e.touchEnd)),e.overlay&&(e.overlay.removeEventListener("touchstart",e.#e.touchStart,!0),e.overlay.removeEventListener("touchmove",e.#e.touchMove,!1),e.overlay.removeEventListener("touchend",e.#e.touchEnd),e.overlay.removeEventListener("touchcancel",e.#e.touchEnd),e.overlay.removeEventListener("click",e.#e.overlayClick)),e.panel&&(e.panel.removeEventListener("transitionend",e.#e.transitionEnd),e.panel.removeEventListener("click",e.#e.actionClick)),document.removeEventListener("keydown",e.#a)}toggleBodyScroll(e){const t=this;e?(t.#r=window.pageYOffset,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${t.#r}px`,document.body.style.width="100%"):(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("position"),document.body.style.removeProperty("top"),document.body.style.removeProperty("width"),window.scrollTo(0,t.#r),t.#r=0)}panelDragStart(e){const t=this,n=t.drag;n.startY=e.targetTouches[0].screenY,n.direction=null,n.delta=0,t.panel.classList.remove("transitioning");const o=!!e.target.closest("bottom-sheet-header"),r=!!e.target.closest("bottom-sheet-overlay"),a=0===t.panelContent?.scrollTop;n.isHeader=o,n.isOverlay=r,n.isAtTop=a,(o||r||a)&&(n.isDragging=!0)}#s(e){return 10*Math.sqrt(e)*this.#t}panelDragMove(e){const t=this,n=t.drag;if(n.isDragging){if(n.currentY=e.targetTouches[0].screenY,n.delta=n.currentY-n.startY,n.direction||(n.delta<0?n.direction="up":n.direction="down"),!n.isHeader&&!n.isOverlay){if(!n.isAtTop)return;if("up"===n.direction)return}if(e.cancelable&&e.preventDefault(),e.stopPropagation(),n.delta<0){const e=Math.abs(n.delta),o=t.#s(e);return void(t.panel.style.transform=`translate3d(0,${-o}px,0)`)}n.delta>0&&(t.panel.style.transform=`translate3d(0,${n.delta}px,0)`,n.delta,t.#n)}}panelDragEnd(e){const t=this,n=t.drag;if(n.isDragging){if(n.isDragging=!1,t.panel.classList.add("transitioning"),n.delta<0)return n.delta=0,n.direction=null,void t.show();if(n.delta>t.#n)return n.delta=0,n.direction=null,void t.hide();n.delta=0,n.direction=null,t.show()}}handleTransitionEnd(e){const t=this;"transform"===e.propertyName&&t.panel.classList.remove("transitioning")}show(){const e=this;window.innerWidth>e.maxDisplayWidth||(e.setAttribute("aria-hidden","false"),e.removeAttribute("inert"),e.panel.classList.add("transitioning"),e.panel.style.transform=null,e.toggleBodyScroll(!0),e.dispatchEvent(new CustomEvent("bottomsheet:open",{bubbles:!0,detail:{sheet:e}})))}hide(){const e=this;e.setAttribute("aria-hidden","true"),e.setAttribute("inert",""),e.panel.classList.add("transitioning"),e.panel.style.transform=null,e.toggleBodyScroll(!1),e.dispatchEvent(new CustomEvent("bottomsheet:close",{bubbles:!0,detail:{sheet:e}}))}}class BottomSheetPanel extends HTMLElement{constructor(){super()}}class BottomSheetContent extends HTMLElement{constructor(){super()}}class BottomSheetOverlay extends HTMLElement{constructor(){super()}}class BottomSheetHeader extends HTMLElement{constructor(){super()}}customElements.define("bottom-sheet",BottomSheet),customElements.define("bottom-sheet-panel",BottomSheetPanel),customElements.define("bottom-sheet-content",BottomSheetContent),customElements.define("bottom-sheet-overlay",BottomSheetOverlay),customElements.define("bottom-sheet-header",BottomSheetHeader),e.BottomSheet=BottomSheet,e.BottomSheetContent=BottomSheetContent,e.BottomSheetHeader=BottomSheetHeader,e.BottomSheetOverlay=BottomSheetOverlay,e.BottomSheetPanel=BottomSheetPanel});
