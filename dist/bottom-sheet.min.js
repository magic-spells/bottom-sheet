!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";const e=(e,t)=>{let n;return function(...o){n||(e.apply(this,o),n=!0,setTimeout((()=>n=!1),t))}};class BottomSheet extends HTMLElement{#e;#t;#n;#o;#s;#i;#a=1/0;static get observedAttributes(){return["max-display-width"]}attributeChangedCallback(e,t,n){if(t!==n&&"max-display-width"===e)if(null===n||"none"===n)this.maxDisplayWidth=1/0;else{const e=parseInt(n);this.maxDisplayWidth=isNaN(e)?1/0:e}}get maxDisplayWidth(){return this.#a}set maxDisplayWidth(e){this.#a=e,e===1/0?this.removeAttribute("max-display-width"):this.setAttribute("max-display-width",e)}constructor(){super();const t=this;t.setAttribute("aria-hidden",!0);const n=t.getAttribute("max-display-width");if(null!==n&&"none"!==n){const e=parseInt(n);t.maxDisplayWidth=isNaN(e)?1/0:e}else{const e=t.dataset.maxWidth;if(e){const n=parseInt(e);t.maxDisplayWidth=isNaN(n)?1/0:n}else t.maxDisplayWidth=1/0}t.drag={isDragging:!1,startY:0,currentY:0,endY:0,delta:0},t.threshold=100,t.panel=t.querySelector(":scope > bottom-sheet-panel"),t.panelContent=t.panel.querySelector(":scope > bottom-sheet-content"),t.overlay=t.querySelector("bottom-sheet-overlay"),t.header=t.querySelector("bottom-sheet-header"),this.#e=this.panelDragStart.bind(this),this.#t=this.panelDragMove.bind(this),this.#n=this.panelDragEnd.bind(this),this.#o=this.handleTransitionEnd.bind(this),this.#s=this.hide.bind(this),this.#i=e((()=>{console.log("window resize throttle"),window.innerWidth>t.maxDisplayWidth&&t.hide()}),100),t.setupAriaAttributes(),t.bindUI()}setupAriaAttributes(){const e=this;e.setAttribute("role","dialog"),e.setAttribute("aria-hidden","true"),e.setAttribute("aria-modal","true"),e.setAttribute("inert",""),e.hasAttribute("aria-label")||e.setAttribute("aria-label","Bottom sheet content")}#r=e=>{"Escape"===e.key&&"false"===this.getAttribute("aria-hidden")&&(e.preventDefault(),this.hide())};bindUI(){const e=this;e.header&&(e.header.addEventListener("touchstart",this.#e,!0),e.header.addEventListener("touchmove",this.#t,!1),e.header.addEventListener("touchend",this.#n),e.header.addEventListener("touchcancel",this.#n)),e.panelContent&&(e.panelContent.addEventListener("touchstart",this.#e,!0),e.panelContent.addEventListener("touchmove",this.#t,!1),e.panelContent.addEventListener("touchend",this.#n),e.panelContent.addEventListener("touchcancel",this.#n)),e.overlay&&(e.overlay.addEventListener("touchstart",this.#e,!0),e.overlay.addEventListener("touchmove",this.#t,!1),e.overlay.addEventListener("touchend",this.#n),e.overlay.addEventListener("touchcancel",this.#n),e.overlay.addEventListener("click",this.#s)),e.panel&&e.panel.addEventListener("transitionend",this.#o),document.addEventListener("keydown",this.#r)}connectedCallback(){window.addEventListener("resize",this.#i),window.innerWidth>this.maxDisplayWidth&&this.hide()}disconnectedCallback(){const e=this;window.removeEventListener("resize",this.#i),e.header&&(e.header.removeEventListener("touchstart",this.#e,!0),e.header.removeEventListener("touchmove",this.#t,!1),e.header.removeEventListener("touchend",this.#n),e.header.removeEventListener("touchcancel",this.#n)),e.panelContent&&(e.panelContent.removeEventListener("touchstart",this.#e,!0),e.panelContent.removeEventListener("touchmove",this.#t,!1),e.panelContent.removeEventListener("touchend",this.#n),e.panelContent.removeEventListener("touchcancel",this.#n)),e.overlay&&(e.overlay.removeEventListener("touchstart",this.#e,!0),e.overlay.removeEventListener("touchmove",this.#t,!1),e.overlay.removeEventListener("touchend",this.#n),e.overlay.removeEventListener("touchcancel",this.#n),e.overlay.removeEventListener("click",this.#s)),e.panel&&e.panel.removeEventListener("transitionend",this.#o),document.removeEventListener("keydown",this.#r)}toggleBodyScroll(e){const t=this;e?(t.scrollPosition=window.pageYOffset,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${t.scrollPosition}px`,document.body.style.width="100%"):(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("position"),document.body.style.removeProperty("top"),document.body.style.removeProperty("width"),window.scrollTo(0,t.scrollPosition),t.scrollPosition=0)}panelDragStart(e){const t=this,n=t.drag;n.startY=e.targetTouches[0].screenY,n.direction=!1,n.delta=0,t.panel.classList.remove("transitioning"),(0===t.panelContent.scrollTop||e.target.closest("bottom-sheet-header")||e.target.closest("bottom-sheet-overlay"))&&(n.isDragging=!0)}#d(e,t=.3){return 10*Math.sqrt(e)*t}panelDragMove(e){const t=this,n=t.drag;if(n.isDragging){if(n.currentY=e.targetTouches[0].screenY,n.delta=n.currentY-n.startY,!n.direction){if(n.delta<0)return void(n.isDragging=!1);n.direction=!0}if(n.delta<0){const e=this.#d(Math.abs(n.delta),.1);t.panel.style.transform=`translate3d(0,${-e}px,0)`}else if(n.delta>0){e.cancelable&&e.preventDefault(),e.stopPropagation();const o=100;let s;if(n.delta<=o)s=n.delta;else{const e=n.delta-o;s=o+this.#d(e,.3)}t.panel.style.transform=`translate3d(0,${s}px,0)`}}}panelDragEnd(e){const t=this,n=t.drag;if(n.isDragging){if(n.isDragging=!1,n.delta>t.threshold)return n.delta=0,void t.hide();n.delta=0,t.show()}}handleTransitionEnd(e){"transform"===e.propertyName&&this.panel.classList.remove("transitioning")}show(){const e=this;window.innerWidth>e.maxDisplayWidth||(e.setAttribute("aria-hidden","false"),e.removeAttribute("inert"),e.panel.classList.add("transitioning"),e.panel.style.transform=null,e.toggleBodyScroll(!0),this.dispatchEvent(new CustomEvent("bottomsheet:open",{bubbles:!0,detail:{sheet:this}})))}hide(){const e=this;e.setAttribute("aria-hidden","true"),e.setAttribute("inert",""),e.panel.classList.add("transitioning"),e.panel.style.transform=null,e.toggleBodyScroll(!1),this.dispatchEvent(new CustomEvent("bottomsheet:close",{bubbles:!0,detail:{sheet:this}}))}}class BottomSheetPanel extends HTMLElement{constructor(){super()}}class BottomSheetContent extends HTMLElement{constructor(){super()}}class BottomSheetOverlay extends HTMLElement{constructor(){super()}}class BottomSheetHeader extends HTMLElement{constructor(){super()}}customElements.define("bottom-sheet",BottomSheet),customElements.define("bottom-sheet-panel",BottomSheetPanel),customElements.define("bottom-sheet-content",BottomSheetContent),customElements.define("bottom-sheet-overlay",BottomSheetOverlay),customElements.define("bottom-sheet-header",BottomSheetHeader)}));
